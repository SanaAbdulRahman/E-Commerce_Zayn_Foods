<!DOCTYPE html>
<html lang="en">

<head>
	<title>Your Cart</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="icon" type="image/png" href="images/icons/favicon.png" />

	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">

	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">

	<link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">

	<link rel="stylesheet" type="text/css" href="fonts/linearicons-v1.0.0/icon-font.min.css">

	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">

	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">

	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">

	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">

	<link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">

	<link rel="stylesheet" type="text/css" href="vendor/slick/slick.css">

	<link rel="stylesheet" type="text/css" href="vendor/MagnificPopup/magnific-popup.css">

	<link rel="stylesheet" type="text/css" href="vendor/perfect-scrollbar/perfect-scrollbar.css">

	<link rel="stylesheet" type="text/css" href="stylesheets/util.css">
	<link rel="stylesheet" type="text/css" href="stylesheets/main.css">
	<link rel="stylesheet" href="stylesheets/style.css">

</head>

<body class="animsition">

	<!-- Header -->
	<header class="header-v4">
		<!-- Header desktop -->
		<div class="container-menu-desktop">
			<!-- Topbar -->
			<div class="top-bar">
				<div class="content-topbar flex-sb-m h-full container">
					<div class="left-top-bar p-l-22">
						Free shipping for orders above ₹499
					</div>
				</div>
			</div>

			<div class="wrap-menu-desktop">
				<nav class="limiter-menu-desktop container">

					<!-- Logo desktop -->
					<a href="#" class="logo">
						<img src="images/icons/logo-01.png" alt="IMG-LOGO">
					</a>

					<!-- Menu desktop -->
					<div class="menu-desktop">
						<ul class="main-menu">
							<li>
								<a href="/">Home</a>
							</li>

							<li>
								<a href="/dishes">Dishes</a>
							</li>

							<li>
								<a href="/orders">Orders</a>
							</li>

							<li>
								<a href="/about">About</a>
							</li>

							<li>
								<a href="/contact">Contact</a>
							</li>
						</ul>
					</div>

					<!-- Icon header -->
					<div class="wrap-icon-header flex-w flex-r-m">
						<a href="/myprofile"
							class="icon-header-item cl2 hov-cl1 trans-04 p-r-10 p-l-22 js-show-myaccount">
							<i class="zmdi zmdi-account"></i>
						</a>
					</div>
				</nav>
			</div>
		</div>

		<!-- Header Mobile -->
		<div class="wrap-header-mobile">
			<!-- Logo moblie -->
			<div class="logo-mobile">
				<a href="/"><img src="images/icons/logo-01.png" alt="IMG-LOGO"></a>
			</div>

			<!-- Icon header -->
			<div class="wrap-icon-header flex-w flex-r-m m-r-15">
				<a href="/myprofile" class="icon-header-item cl2 hov-cl1 trans-04 p-r-10 p-l-22 js-show-myaccount">
					<i class="zmdi zmdi-account"></i>
				</a>
			</div>

			<!-- Button show menu -->
			<div class="btn-show-menu-mobile hamburger hamburger--squeeze">
				<span class="hamburger-box">
					<span class="hamburger-inner"></span>
				</span>
			</div>
		</div>
		<!-- Menu Mobile -->
		<div class="menu-mobile">
			<ul class="main-menu-m">
				<li class="active-menu">
					<a href="/">Home</a>
				</li>
				<li>
					<a href="/dishes">Dishes</a>
				</li>

				<li>
					<a href="/orders">Orders</a>
				</li>

				<li>
					<a href="/about">About</a>
				</li>

				<li>
					<a href="/contact">Contact</a>
				</li>
			</ul>
		</div>
	</header>

	<% if(cartData.dishes.length <=0){ %>
		<div class="container-fluid mt-100">
			<div class="row">
				<div class="col-md-12">
					<div class="card">
						<div class="card-body cart">
							<div class="col-sm-12 empty-cart-cls text-center">
								<img src="/images/empty-cart.png" width="130" height="130"
									class="img-fluid mb-4 mr-3" />

								<!-- <img src="https://i.imgur.com/dCdflKN.png" width="130" height="130" class="img-fluid mb-4 mr-3"> -->
								<h3><strong>Your Cart is Empty</strong></h3>
								<h4>Add something to make me happy :)</h4>
								<a href="/" class="btn btn-primary cart-btn-transform m-3" data-abc="true">continue
									shopping</a>
							</div>
						</div>
						<!-- <div class="container">
			<div class="justify-content-center">
				<img src="/images/cartempty.png" alt="">-->
					</div>
				</div>
			</div>
		</div>
		<%} else {%>
			<!-- Cart -->
			<form class="bg0 p-t-75 p-b-85">
				<div class="container">
					<div class="row">
						<div class="col-lg-10 col-xl-7 m-lr-auto m-b-50">
							<div class="m-l-25 m-r--38 m-lr-0-xl">
								<div class="wrap-table-shopping-cart">
									<table class="table-shopping-cart">
										<tr class="table_head">
											<th class="column-1">Product</th>
											<th class="column-2"></th>
											<th class="column-3">Price</th>
											<th class="column-4">Quantity</th>
											<th class="column-5">Total</th>
										</tr>
										<% if(cartData.dishes){ %>
											<% cartData.dishes.forEach((cartItem)=>{ %>
												<tr class="table_row">
													<td class="column-1">
														<a href="/deleteProductFromCart?productId=<%=cartItem.id%>">
															<div class="how-itemcart1">
																<img src="<%= cartItem.image%>" alt="IMG">
															</div>
														</a>
													</td>
													<td class="column-2">
														<%= cartItem.name%>
													</td>
													<td class="column-3">₹<%=cartItem.price%>
													</td>
													<td class="column-4">
														<div class="wrap-num-product flex-w m-l-auto m-r-0">
															<a onclick="decrementCartItemQuantity('<%=cartItem.id%>', '<%=cartItem.price%>', '<%=cartItem.totalPrice%>')"
																class="btn-num-product-down cl8 hov-btn3 trans-04 flex-c-m">
																<i class="fs-16 zmdi zmdi-minus"></i>
															</a>

															<input class="mtext-104 cl3 txt-center num-product"
																type="number" name="num-product1"
																value="<%= cartItem.quantity%>">

															<a onclick="incrementCartItemQuantity('<%=cartItem.id%>', '<%=cartItem.price%>', '<%=cartItem.totalPrice%>')"
																class="btn-num-product-up cl8 hov-btn3 trans-04 flex-c-m">
																<i class="fs-16 zmdi zmdi-plus"></i>
															</a>
														</div>
													</td>
													<td class="column-5" id="totalPrice<%=cartItem.id%>">₹
														<%=cartItem.totalPrice%>
													</td>
												</tr>
												<% }) %>
													<%}%>
									</table>
								</div>

								<div class="flex-w flex-sb-m bor15 p-t-18 p-b-15 p-lr-40 p-lr-15-sm">
									<% if (cartData.couponApplied) { %>
										<div style="width: 100vw;">
											<div class="alert alert-success d-flex justify-content-between"
												role="alert">
												<p>
													<%= cartData.coupon.couponCode %> is applied. <br>
														<%= cartData.coupon.maximumDiscountableAmount%> is
															maximum
															discountable amount of this coupon

												</p>
												<p class="text-danger pointer" onclick="removeCoupon()">
													Remove
												</p>
											</div>
										</div>
										<% } %>
											<div class="flex-w flex-m m-r-20 m-tb-5">
												<input class="stext-104 cl2 plh4 size-117-1 bor13 p-lr-20 m-r-10 m-tb-5"
													type="text" name="coupon" id="coupon" placeholder="Coupon Code"
													style="text-transform: uppercase;">
											</div>

											<div class="flex-c-m stext-101 cl2 size-119 bg8 bor13 hov-btn3 p-lr-15 trans-04 pointer m-tb-10"
												onclick="applyCoupon()">
												Apply coupon
											</div>
											<div style="width: 100vw;" id="couponError"></div>
								</div>
							</div>
						</div>

						<div class="col-sm-10 col-lg-7 col-xl-5 m-lr-auto m-b-50">
							<div class="bor10 p-lr-40 p-t-30 p-b-40 m-l-63 m-r-40 m-lr-0-xl p-lr-15-sm">
								<div class="flex-w flex-t bor12 p-t-15 p-b-30">
									<h4 class="mtext-109 cl2 p-b-30 p-t-5">
										Address
									</h4>
									<ul class="nav nav-tabs">
										<li class="nav-item"><a data-toggle="tab" href="#savedAddress"
												class="p-r-15 nav-link active">Saved Address</a></li>
										<li class="nav-item"><a data-toggle="tab" href="#newAddress"
												class="nav-link">New Address</a></li>
									</ul>

									<div class="size-209-1 p-r-18 p-r-0-sm w-full-ssm p-t-30">
										<div class="tab-content">
											<div id="savedAddress" class="tab-pane fade active show">
												<div class="rs1-select2 rs2-select2 bor8 bg0 m-b-22 m-t-9">
													<select class="js-select2" name="address" id="address"
														onchange="addressSelector()">
														<option class="select">Select from list</option>
														<% addresses.forEach((address)=> { %>
															<option value="'<%=address._id%>'">
																<%=address.flatNo%> <br>
																	<%=address.street%> <br>
																		<%=address.pincode%>
															</option>
															<% }) %>
													</select>
													<div class="dropDownSelect2"></div>
												</div>

												<span class="stext-112 cl8">
													Edit Address
												</span>
												<div id="savedAdress">
													<form>
														<div class="wrap-input1 w-full p-b-4 mb-4 m-t-9">
															<input class="input1 bg-none plh1 stext-107 cl2" type="text"
																name="flatNo" id="savedFlatNo"
																placeholder="Flat Name, No">
															<div class="focus-input1 trans-04"></div>
														</div>
														<div class="wrap-input1 w-full p-b-4 mb-4 mt-2">
															<input class="input1 bg-none plh1 stext-107 cl2" type="text"
																name="street" id="savedStreet" placeholder="Street">
															<div class="focus-input1 trans-04"></div>
														</div>
														<div class="wrap-input1 w-full p-b-4 mb-4 mt-2">
															<input class="input1 bg-none plh1 stext-107 cl2" type="text"
																name="landmark" id="savedLandmark"
																placeholder="Landmark">
															<div class="focus-input1 trans-04"></div>
														</div>
														<div class="wrap-input1 w-full p-b-4 mb-4 mt-2">
															<input class="input1 bg-none plh1 stext-107 cl2" type="text"
																name="district" id="savedDistrict"
																placeholder="District">
															<div class="focus-input1 trans-04"></div>
														</div>
														<div class="wrap-input1 w-full p-b-4 mb-4 mt-2">
															<input class="input1 bg-none plh1 stext-107 cl2" type="text"
																name="pincode" id="savedPincode" placeholder="Pincode">
															<div class="focus-input1 trans-04"></div>
														</div>

														<div id="savedValidationError"></div>

														<div class="d-flex justify-content-center">
															<button type='button' onclick="updateAddress()"
																class="flex-c-m stext-101 cl2 size-115 bg8 bor13 hov-btn3 p-lr-15 trans-04 pointer">
																Update Address
															</button>
														</div>
													</form>
												</div>
											</div>
											<div id="newAddress" class="tab-pane fade in">
												<div id="newAdress">
													<form action="/newAddress" method="post">
														<div class="wrap-input1 w-full p-b-4 mb-4 m-t-9">
															<input class="input1 bg-none plh1 stext-107 cl2" type="text"
																name="flatNo" id="flatNo" placeholder="Flat Name, No">
															<div class="focus-input1 trans-04"></div>
														</div>
														<div class="wrap-input1 w-full p-b-4 mb-4 mt-2">
															<input class="input1 bg-none plh1 stext-107 cl2" type="text"
																name="street" id="street" placeholder="Street">
															<div class="focus-input1 trans-04"></div>
														</div>
														<div class="wrap-input1 w-full p-b-4 mb-4 mt-2">
															<input class="input1 bg-none plh1 stext-107 cl2" type="text"
																name="landmark" id="landmark" placeholder="Landmark">
															<div class="focus-input1 trans-04"></div>
														</div>
														<div class="wrap-input1 w-full p-b-4 mb-4 mt-2">
															<input class="input1 bg-none plh1 stext-107 cl2" type="text"
																name="district" id="district" placeholder="District">
															<div class="focus-input1 trans-04"></div>
														</div>
														<div class="wrap-input1 w-full p-b-4 mb-4 mt-2">
															<input class="input1 bg-none plh1 stext-107 cl2" type="text"
																name="pincode" id="pincode" placeholder="Pincode">
															<div class="focus-input1 trans-04"></div>
														</div>

														<div id="validationError"></div>

														<div class="flex-w">
															<button type='button' onclick="addAddress()"
																class="flex-c-m stext-101 cl2 size-115 bg8 bor13 hov-btn3 p-lr-15 trans-04 pointer">
																Save Address
															</button>
														</div>
													</form>
												</div>
											</div>
										</div>
									</div>
								</div>
								<h4 class="mtext-109 cl2 p-b-30 p-t-30">
									Cart Totals
								</h4>

								<div class="flex-w flex-t bor12 p-b-13">
									<div class="size-208">
										<span class="stext-110 cl2">
											Subtotal :
										</span>
									</div>

									<div class="size-209">
										<span class="mtext-110 cl2">₹</span><span class="mtext-110 cl2" id="subtotal">
											<%=cartData.cartTotal%>
										</span>
									</div>

									<div class="size-208 p-t-15">
										<span class="stext-110 cl2">
											Shipping :
										</span>
									</div>

									<div class="size-209 p-t-15">
										<span class="mtext-110 cl2">₹</span><span class="mtext-110 cl2" id="shipping">
											<%=cartData.shippingCharge%>
										</span>
									</div>
									<div class="size-208 p-t-15">
										<span class="stext-110 cl2">
											Discount :
										</span>
									</div>
									<div class="size-209 p-t-15">
										<span class="mtext-110 cl2">₹</span><span class="mtext-110 cl12" id="discount">
											<%=cartData.discount%>
										</span>
									</div>
								</div>
								<div class="flex-w flex-t p-t-27 p-b-33">
									<div class="size-208">
										<span class="mtext-101 cl2">
											Total:
										</span>
									</div>

									<div class="size-209 p-t-1">
										<span class="mtext-110 cl2">₹</span><span class="mtext-110 cl2" id="grandTotal">
											<%=cartData.grandTotal%>
										</span>
									</div>
								</div>
								<div id="checkoutError"></div>

								<button type='button' onclick="checkout('<%=cartData.grandTotal%>')"
									class="flex-c-m stext-101 cl0 size-116 bg3 bor14 hov-btn3 p-lr-15 trans-04 pointer">
									Proceed to Checkout
								</button>
							</div>
						</div>
					</div>
				</div>
			</form>
			<%}%>
				<!-- Footer -->
				<%- include('../partials/footer.ejs')%>
					<!-- Back to top -->
					<div class="btn-back-to-top" id="myBtn">
						<span class="symbol-btn-back-to-top">
							<i class="zmdi zmdi-chevron-up"></i>
						</span>
					</div>
					<script src="js/fetch/cartFetch.js"></script>
					<script src="js/newAddressForm.js"></script>
					<script src="vendor/jquery/jquery-3.2.1.min.js"></script>

					<script src="vendor/animsition/js/animsition.min.js"></script>

					<script src="vendor/bootstrap/js/popper.js"></script>
					<script src="vendor/bootstrap/js/bootstrap.min.js"></script>

					<script src="vendor/select2/select2.min.js"></script>
					<script>
						$(".js-select2").each(function () {
							$(this).select2({
								minimumResultsForSearch: 20,
								dropdownParent: $(this).next('.dropDownSelect2')
							});
						})
					</script>
					<script>
						$('.js-pscroll').each(function () {
							$(this).css('position', 'relative');
							$(this).css('overflow', 'hidden');
							var ps = new PerfectScrollbar(this, {
								wheelSpeed: 1,
								scrollingThreshold: 1000,
								wheelPropagation: false,
							});

							$(window).on('resize', function () {
								ps.update();
							})
						});

					</script>
					<script src="vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>

					<script src="vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>

					<script src="js/main.js"></script>

</body>

</html>